Attack_name: 'Signed Binary Proxy Execution: Compiled HTML File'
Attack_description: |-
  Adversaries may abuse Compiled HTML files (.chm) to conceal malicious code. CHM files are commonly distributed as part of the Microsoft HTML Help system. CHM files are compressed compilations of various content such as HTML documents, images, and scripting/web related programming languages such VBA, JScript, Java, and ActiveX. (Citation: Microsoft HTML Help May 2018) CHM content is displayed using underlying components of the Internet Explorer browser (Citation: Microsoft HTML Help ActiveX) loaded by the HTML Help executable program (hh.exe). (Citation: Microsoft HTML Help Executable Program)

  A custom CHM file containing embedded payloads could be delivered to a victim then triggered by [User Execution](https://attack.mitre.org/techniques/T1204). CHM execution may also bypass application application control on older and/or unpatched systems that do not account for execution of binaries through hh.exe. (Citation: MsitPros CHM Aug 2017) (Citation: Microsoft CVE-2017-8625 Aug 2017)
guid: 4f83adda-f5ec-406d-b318-9773c9ca92e5
name: Invoke CHM with Script Engine and Help Topic
tactic:
  - defense-evasion
technique:
  - T1218.001
os:
  - windows
description: Executes a CHM file with a defined script engine, ITS Protocol Handler, and help topic extension.
executor: powershell
sigma: true
sigma_rule:
  - id: 68c8acb4-1b60-4890-8e82-3ddf7a6dba84
    name: proc_creation_win_hh_chm_execution.yml
  - id: d21374ff-f574-44a7-9998-4a8c8bf33d7d
    name: proc_creation_win_wmiprvse_spawning_process.yml
  - id: fb843269-508c-4b76-8b8d-88679db22ce7
    name: proc_creation_win_powershell_encode.yml
  - id: 52cad028-0ff0-4854-8f67-d25dfcbc78b4
    name: proc_creation_win_html_help_spawn.yml
  - id: 313fbb0a-a341-4682-848d-6d6f8c4fab7c
    name: posh_ps_susp_windowstyle.yml
