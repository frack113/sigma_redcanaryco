guid: 55295ab0-a703-433b-9ca4-ae13807de12f
name: Dumping LSA Secrets
tactic:
  - credential-access
technique:
  - T1003.004
sigma: false
sigma_rule: []
os:
  - windows
description: |
  Dump secrets key from Windows registry
  When successful, the dumped file will be written to $env:Temp\secrets.
  Attackers may use the secrets key to assist with extracting passwords and enumerating other sensitive system information.
  https://pentestlab.blog/2018/04/04/dumping-clear-text-credentials/#:~:text=LSA%20Secrets%20is%20a%20registry,host%2C%20local%20security%20policy%20etc.
Attack_name: LSA Secrets
Attack_description: |-
  Adversaries with SYSTEM access to a host may attempt to access Local Security Authority (LSA) secrets, which can contain a variety of different credential materials, such as credentials for service accounts.(Citation: Passcape LSA Secrets)(Citation: Microsoft AD Admin Tier Model)(Citation: Tilbury Windows Credentials) LSA secrets are stored in the registry at <code>HKEY_LOCAL_MACHINE\SECURITY\Policy\Secrets</code>. LSA secrets can also be dumped from memory.(Citation: ired Dumping LSA Secrets)

  [Reg](https://attack.mitre.org/software/S0075) can be used to extract from the Registry. [Mimikatz](https://attack.mitre.org/software/S0002) can be used to extract secrets from memory.(Citation: ired Dumping LSA Secrets)
