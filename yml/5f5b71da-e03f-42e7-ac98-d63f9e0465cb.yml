Attack_name: Re-opened Applications
Attack_description: |-
  Adversaries may modify plist files to automatically run an application when a user logs in. When a user logs out or restarts via the macOS Graphical User Interface (GUI), a prompt is provided to the user with a checkbox to "Reopen windows when logging back in".(Citation: Re-Open windows on Mac) When selected, all applications currently open are added to a property list file named <code>com.apple.loginwindow.[UUID].plist</code> within the <code>~/Library/Preferences/ByHost</code> directory.(Citation: Methods of Mac Malware Persistence)(Citation: Wardle Persistence Chapter) Applications listed in this file are automatically reopened upon the userâ€™s next logon.

  Adversaries can establish [Persistence](https://attack.mitre.org/tactics/TA0003) by adding a malicious application path to the <code>com.apple.loginwindow.[UUID].plist</code> file to execute payloads when a user logs in.
guid: 5f5b71da-e03f-42e7-ac98-d63f9e0465cb
name: Re-Opened Applications
tactic:
  - privilege-escalation
  - persistence
technique:
  - T1547.007
os:
  - macos
description: |
  Mac Defaults

  [Reference](https://developer.apple.com/library/content/documentation/MacOSX/Conceptual/BPSystemStartup/Chapters/CustomLogin.html)
executor: sh
sigma: false
sigma_rule: []
