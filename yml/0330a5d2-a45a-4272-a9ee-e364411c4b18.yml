Attack_name: Malicious File
Attack_description: |-
  An adversary may rely upon a user opening a malicious file in order to gain execution. Users may be subjected to social engineering to get them to open a file that will lead to code execution. This user action will typically be observed as follow-on behavior from [Spearphishing Attachment](https://attack.mitre.org/techniques/T1566/001). Adversaries may use several types of files that require a user to execute them, including .doc, .pdf, .xls, .rtf, .scr, .exe, .lnk, .pif, and .cpl.

  Adversaries may employ various forms of [Masquerading](https://attack.mitre.org/techniques/T1036) on the file to increase the likelihood that a user will open it.

  While [Malicious File](https://attack.mitre.org/techniques/T1204/002) frequently occurs shortly after Initial Access it may occur at other phases of an intrusion, such as when an adversary places a file in a shared directory or on a user's desktop hoping that a user will click on it. This activity may also be seen shortly after [Internal Spearphishing](https://attack.mitre.org/techniques/T1534).
guid: 0330a5d2-a45a-4272-a9ee-e364411c4b18
name: Maldoc choice flags command execution
tactic:
  - execution
technique:
  - T1204.002
os:
  - windows
description: |
  This Test uses a VBA macro to execute cmd with flags observed in recent maldoc and 2nd stage downloaders. Upon execution, CMD will be launched.
  Execution is handled by [Invoke-MalDoc](https://github.com/redcanaryco/invoke-atomicredteam/blob/master/Public/Invoke-MalDoc.ps1) to load and execute VBA code into Excel or Word documents.
executor: powershell
sigma: true
sigma_rule:
  - id: e6ce8457-68b1-485b-9bdd-3c2b5d679aa9
    name: image_load_susp_winword_vbadll_load.yml
  - id: 438025f9-5856-4663-83f7-52f878a70a50
    name: proc_creation_win_office_shell.yml
