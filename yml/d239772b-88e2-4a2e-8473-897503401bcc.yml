Attack_name: Ingress Tool Transfer
Attack_description: Adversaries may transfer tools or other files from an external system into a compromised environment. Files may be copied from an external adversary controlled system through the command
  and control channel to bring tools into the victim network or through alternate protocols with another tool such as FTP. Files can also be copied over on Mac and Linux with native tools like scp, rsync,
  and sftp.
guid: d239772b-88e2-4a2e-8473-897503401bcc
name: Download a file with Microsoft Connection Manager Auto-Download
tactic:
  - command-and-control
technique:
  - T1105
os:
  - windows
description: "Uses the cmdl32 to download arbitrary file from the internet. The cmdl32 package is allowed to install the profile used to launch the VPN connection. However, the config is modified to download\
  \ the arbitary file. \nThe issue of cmdl32.exe detecting and deleting the payload by identifying it as not a VPN Servers profile is avoided by setting a temporary TMP folder and denying the delete permission\
  \ to all files for the user.\nUpon successful execution the test will open calculator and Notepad executable for 10 seconds.\nreference:\nhttps://twitter.com/ElliotKillick/status/1455897435063074824\n\
  https://github.com/LOLBAS-Project/LOLBAS/pull/151\nhttps://lolbas-project.github.io/lolbas/Binaries/Cmdl32/\nhttps://strontic.github.io/xcyclopedia/library/cmdl32.exe-FA1D5B8802FFF4A85B6F52A52C871BBB.html\n"
executor: command_prompt
sigma: true
sigma_rule:
  - id: 4f4eaa9f-5ad4-410c-a4be-bc6132b0175a
    name: proc_creation_win_cmd_redirect.yml
  - id: f37aba28-a9e6-4045-882c-d5004043b337
    name: proc_creation_win_susp_cmdl32_lolbas.yml
  - id: 86085955-ea48-42a2-9dd3-85d4c36b167d
    name: proc_creation_win_susp_taskkill.yml
