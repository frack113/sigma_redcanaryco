
[back](../index.md)

Find sigma rule :heavy_check_mark: 

# Attack: Ingress Tool Transfer 

Adversaries may transfer tools or other files from an external system into a compromised environment. Tools or files may be copied from an external adversary-controlled system to the victim network through the command and control channel or through alternate protocols such as [ftp](https://attack.mitre.org/software/S0095). Once present, adversaries may also transfer/spread tools between victim devices within a compromised environment (i.e. [Lateral Tool Transfer](https://attack.mitre.org/techniques/T1570)). 

Files can also be transferred using various [Web Service](https://attack.mitre.org/techniques/T1102)s as well as native or otherwise present tools on the victim system.(Citation: PTSecurity Cobalt Dec 2016)

On Windows, adversaries may use various utilities to download tools, such as `copy`, `finger`, and [PowerShell](https://attack.mitre.org/techniques/T1059/001) commands such as <code>IEX(New-Object Net.WebClient).downloadString()</code> and <code>Invoke-WebRequest</code>. On Linux and macOS systems, a variety of utilities also exist, such as `curl`, `scp`, `sftp`, `tftp`, `rsync`, `finger`, and `wget`.(Citation: t1105_lolbas)

# MITRE
## Tactic
  - command-and-control


## technique
  - T1105


# Test : Windows - PowerShell Download
## OS
  - windows


## Description:
This test uses PowerShell to download a payload.
This technique is used by multiple adversaries and malware families.


## Executor
powershell

# Sigma Rule
 - proc_creation_win_susp_ps_downloadfile.yml (id: 8f70ac5f-1f6f-4f8e-b454-db19561216c5)

 - proc_creation_win_web_request_cmd_and_cmdlets.yml (id: 9fc51a3c-81b3-4fa7-b35f-7c02cf10fd2d)

 - proc_creation_win_powershell_download.yml (id: 3b6ab547-8ec2-4991-b9d2-2b06702a48d7)

 - proc_creation_win_non_interactive_powershell.yml (id: f4bbd493-b796-416e-bbf2-121235348529)

 - posh_pm_susp_download.yml (id: de41232e-12e8-49fa-86bc-c05c7e722df9)

 - posh_ps_susp_download.yml (id: 403c2cc0-7f6b-4925-9423-bfa573bed7eb)

 - posh_ps_web_request_cmd_and_cmdlets.yml (id: 1139d2e2-84b1-4226-b445-354492eba8ba)

 - net_connection_win_binary_github_com.yml (id: 635dbb88-67b3-4b41-9ea5-a3af2dd88153)

 - net_connection_win_powershell_network_connection.yml (id: 1f21ec3f-810d-4b0e-8045-322202e22b4b)



[back](../index.md)
